<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TypeMaster - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–µ—á–∞—Ç–∏</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6c5ce7;
            --primary-dark: #5649c0;
            --secondary: #00cec9;
            --background: #f8f9fa;
            --text: #2d3436;
            --text-light: #636e72;
            --correct: #00b894;
            --incorrect: #d63031;
            --current: var(--primary);
            --card-bg: #ffffff;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            --input-bg: #f8f9fa;
            --input-border: #dfe6e9;
            --missed: #ff7675;
        }

        [data-theme="dark"] {
            --primary: #6c5ce7;
            --primary-dark: #7d6eff;
            --secondary: #00cec9;
            --background: #1a1a2e;
            --text: #e6e6e6;
            --text-light: #b8b8b8;
            --correct: #00b894;
            --incorrect: #ff7675;
            --current: var(--primary);
            --card-bg: #16213e;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            --input-bg: #1a1a2e;
            --input-border: #2d4059;
            --missed: #ff7675;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: background-color 0.3s, color 0.3s, border-color 0.3s;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--background);
            color: var(--text);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            padding: 1rem;
            line-height: 1.6;
        }

        header {
            text-align: center;
            margin-bottom: 1.5rem;
            position: relative;
        }

        h1 {
            font-size: clamp(1.8rem, 5vw, 2.5rem);
            font-weight: 700;
            margin-bottom: 0.5rem;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .subtitle {
            font-size: clamp(0.9rem, 3vw, 1.1rem);
            color: var(--text-light);
            font-weight: 400;
        }

        .theme-toggle {
            position: absolute;
            top: 0;
            right: 0;
            background: none;
            border: none;
            color: var(--text);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            width: 100%;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .card {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            margin-bottom: 1.25rem;
        }

        .dictionary-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1.25rem;
        }

        .dictionary-btn {
            padding: 0.5rem 0.8rem;
            border-radius: 6px;
            border: none;
            background-color: var(--input-bg);
            color: var(--text);
            font-family: inherit;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: clamp(0.8rem, 3vw, 1rem);
        }

        .dictionary-btn:hover {
            background-color: var(--input-border);
        }

        .dictionary-btn.active {
            background-color: var(--primary);
            color: white;
        }

        .typing-area {
            margin-bottom: 1.25rem;
        }

        .timer {
            font-size: clamp(1rem, 4vw, 1.2rem);
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 1rem;
            text-align: center;
        }

        .text-display {
            font-family: 'JetBrains Mono', monospace;
            font-size: clamp(1rem, 4vw, 1.4rem);
            line-height: 1.8;
            margin-bottom: 1.5rem;
            min-height: 6rem;
            padding: 1rem;
            background-color: var(--input-bg);
            border-radius: 8px;
            white-space: pre-wrap;
            word-wrap: break-word;
            overflow-wrap: break-word;
            overflow-y: auto;
            max-height: 200px;
        }

        .input-area {
            width: 100%;
            padding: 0.8rem 1rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: clamp(1rem, 4vw, 1.2rem);
            border: 2px solid var(--input-border);
            border-radius: 8px;
            outline: none;
            transition: border-color 0.2s ease;
            margin-bottom: 1rem;
            background-color: var(--input-bg);
            color: var(--text);
        }

        .input-area:focus {
            border-color: var(--primary);
        }

        .start-btn {
            padding: 0.7rem 1.3rem;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            font-family: inherit;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease;
            align-self: center;
            margin-bottom: 1rem;
            font-size: clamp(0.9rem, 4vw, 1rem);
            width: 100%;
            max-width: 200px;
        }

        .start-btn:hover {
            background-color: var(--primary-dark);
        }

        .stats {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            gap: 0.8rem;
            margin-bottom: 1.5rem;
        }

        .stat-box {
            background-color: var(--card-bg);
            border-radius: 8px;
            padding: 0.8rem;
            text-align: center;
            flex: 1 1 calc(50% - 0.8rem);
            min-width: 120px;
            box-shadow: var(--shadow);
        }

        .stat-value {
            font-size: clamp(1.5rem, 6vw, 2rem);
            font-weight: 700;
            color: var(--primary);
        }

        .stat-label {
            font-size: clamp(0.8rem, 3vw, 0.9rem);
            color: var(--text-light);
        }

        .restart-btn {
            padding: 0.7rem 1.3rem;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            font-family: inherit;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease;
            align-self: center;
            font-size: clamp(0.9rem, 4vw, 1rem);
            width: 100%;
            max-width: 200px;
        }

        .restart-btn:hover {
            background-color: var(--primary-dark);
        }

        .hidden {
            display: none;
        }

        .character {
            position: relative;
        }

        .character.correct {
            color: var(--correct);
        }

        .character.incorrect {
            color: var(--incorrect);
            text-decoration: underline wavy var(--incorrect);
        }

        .character.missed {
            color: var(--missed);
            text-decoration: underline dotted var(--missed);
        }

        .character.current {
            background-color: rgba(108, 92, 231, 0.1);
            border-radius: 2px;
        }

        .character.current::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: -2px;
            width: 100%;
            height: 2px;
            background-color: var(--current);
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        footer {
            text-align: center;
            margin-top: 1.5rem;
            color: var(--text-light);
            font-size: clamp(0.8rem, 3vw, 0.9rem);
        }

        @media (max-width: 480px) {
            .card {
                padding: 1rem;
            }
            
            .dictionary-selector {
                gap: 0.4rem;
            }
            
            .dictionary-btn {
                padding: 0.4rem 0.6rem;
            }
            
            .text-display {
                padding: 0.8rem;
                font-size: 1rem;
                line-height: 1.6;
                min-height: 5rem;
                max-height: 150px;
            }
            
            .input-area {
                padding: 0.7rem;
            }
            
            .stat-box {
                flex: 1 1 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <button class="theme-toggle" id="themeToggle">üåì</button>
            <h1>TypeMaster</h1>
            <p class="subtitle">–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–≤–æ—é —Å–∫–æ—Ä–æ—Å—Ç—å –ø–µ—á–∞—Ç–∏ —Å —Ä–∞–∑–Ω—ã–º–∏ —Å–ª–æ–≤–∞—Ä—è–º–∏</p>
        </header>

        <div class="card">
            <h2>–í—ã–±–µ—Ä–∏—Ç–µ —Å–ª–æ–≤–∞—Ä—å</h2>
            <div class="dictionary-selector">
                <button class="dictionary-btn active" data-dictionary="russian">–†—É—Å—Å–∫–∏–µ —Å–ª–æ–≤–∞</button>
                <button class="dictionary-btn" data-dictionary="russian_proverbs">–ü–æ—Å–ª–æ–≤–∏—Ü—ã</button>
                <button class="dictionary-btn" data-dictionary="programming">–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ</button>
                <button class="dictionary-btn" data-dictionary="quotes">–¶–∏—Ç–∞—Ç—ã</button>
            </div>
        </div>

        <div class="card typing-area">
            <button class="start-btn" id="startBtn">–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç</button>
            <div class="timer hidden" id="timer">60</div>
            <div class="text-display hidden" id="textDisplay"></div>
            <input type="text" class="input-area hidden" id="typingInput" placeholder="–ù–∞—á–Ω–∏—Ç–µ –ø–µ—á–∞—Ç–∞—Ç—å –∑–¥–µ—Å—å..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
            <div class="stats hidden" id="statsArea">
                <div class="stat-box">
                    <div class="stat-value" id="wpmStat">0</div>
                    <div class="stat-label">WPM</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="accuracyStat">0</div>
                    <div class="stat-label">–¢–æ—á–Ω–æ—Å—Ç—å</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="correctStat">0</div>
                    <div class="stat-label">–ü—Ä–∞–≤–∏–ª—å–Ω–æ</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="incorrectStat">0</div>
                    <div class="stat-label">–û—à–∏–±–∫–∏</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="missedStat">0</div>
                    <div class="stat-label">–ü—Ä–æ–ø—É—â–µ–Ω–æ</div>
                </div>
            </div>
            <button class="restart-btn hidden" id="restartBtn">–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞</button>
        </div>
    </div>

    <footer>
        <p>TypeMaster - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏ —É–ª—É—á—à–∏—Ç–µ —Å–≤–æ—é —Å–∫–æ—Ä–æ—Å—Ç—å –ø–µ—á–∞—Ç–∏</p>
    </footer>

    <script>
        const dictionaries = {
            russian: [
                "–ø—Ä–∏–≤–µ—Ç", "–º–∏—Ä", "–ø—Ä–æ–≥—Ä–∞–º–º–∞", "—è–∑—ã–∫", "–∫–æ–º–ø—å—é—Ç–µ—Ä", "–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞", "–º–æ–Ω–∏—Ç–æ—Ä", "–º—ã—à—å", "—Å–∏—Å—Ç–µ–º–∞", "—Ñ–∞–π–ª",
                "–ø–∞–ø–∫–∞", "–¥–æ–∫—É–º–µ–Ω—Ç", "—Ç–µ–∫—Å—Ç", "—Å—Ç—Ä–∞–Ω–∏—Ü–∞", "—Å—Ç—Ä–æ–∫–∞", "—Å–ª–æ–≤–æ", "–±—É–∫–≤–∞", "—Ü–∏—Ñ—Ä–∞", "—á–∏—Å–ª–æ", "–∫–æ–¥",
                "–∞–ª–≥–æ—Ä–∏—Ç–º", "–ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç", "—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫", "–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å", "—Ñ—É–Ω–∫—Ü–∏—è", "–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è", "–∑–Ω–∞—á–µ–Ω–∏–µ", "–æ–ø–µ—Ä–∞—Ç–æ—Ä", "—É—Å–ª–æ–≤–∏–µ", "—Ü–∏–∫–ª",
                "–º–∞—Å—Å–∏–≤", "–æ–±—ä–µ–∫—Ç", "–∫–ª–∞—Å—Å", "–º–µ—Ç–æ–¥", "–ø–∞—Ä–∞–º–µ—Ç—Ä", "–∞—Ä–≥—É–º–µ–Ω—Ç", "–≤–æ–∑–≤—Ä–∞—Ç", "–∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞", "—Å—Ç—Ä–æ–∫–∞", "–ª–æ–≥–∏—á–µ—Å–∫–∏–π"
            ],
            russian_proverbs: [
                "–ë–µ–∑ —Ç—Ä—É–¥–∞ –Ω–µ –≤—ã—Ç–∞—â–∏—à—å –∏ —Ä—ã–±–∫—É –∏–∑ –ø—Ä—É–¥–∞",
                "–í –≥–æ—Å—Ç—è—Ö —Ö–æ—Ä–æ—à–æ –∞ –¥–æ–º–∞ –ª—É—á—à–µ",
                "–í–æ–ª–∫–æ–≤ –±–æ—è—Ç—å—Å—è –≤ –ª–µ—Å –Ω–µ —Ö–æ–¥–∏—Ç—å",
                "–ì–ª–∞–∑–∞ –±–æ—è—Ç—Å—è –∞ —Ä—É–∫–∏ –¥–µ–ª–∞—é—Ç",
                "–î–µ–ª–æ –º–∞—Å—Ç–µ—Ä–∞ –±–æ–∏—Ç—Å—è",
                "–ó–∞ –¥–≤—É–º—è –∑–∞–π—Ü–∞–º–∏ –ø–æ–≥–æ–Ω–∏—à—å—Å—è –Ω–∏ –æ–¥–Ω–æ–≥–æ –Ω–µ –ø–æ–π–º–∞–µ—à—å",
                "–ö–æ–ø–µ–π–∫–∞ —Ä—É–±–ª—å –±–µ—Ä–µ–∂–µ—Ç",
                "–ö—Ç–æ —Ä–∞–Ω–æ –≤—Å—Ç–∞–µ—Ç —Ç–æ–º—É –±–æ–≥ –ø–æ–¥–∞–µ—Ç",
                "–õ—é–±–∏—à—å –∫–∞—Ç–∞—Ç—å—Å—è –ª—é–±–∏ –∏ —Å–∞–Ω–æ—á–∫–∏ –≤–æ–∑–∏—Ç—å",
                "–ú–æ—Å–∫–≤–∞ –Ω–µ —Å—Ä–∞–∑—É —Å—Ç—Ä–æ–∏–ª–∞—Å—å"
            ],
            programming: [
                "—Ñ—É–Ω–∫—Ü–∏—è", "–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è", "—Ü–∏–∫–ª", "–º–∞—Å—Å–∏–≤", "–æ–±—ä–µ–∫—Ç", "–∫–ª–∞—Å—Å", "–º–µ—Ç–æ–¥", "–ø–∞—Ä–∞–º–µ—Ç—Ä", "–∞—Ä–≥—É–º–µ–Ω—Ç", "–≤–æ–∑–≤—Ä–∞—Ç",
                "–∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞", "—É—Å–ª–æ–≤–∏–µ", "–æ–ø–µ—Ä–∞—Ç–æ—Ä", "–ª–æ–≥–∏—á–µ—Å–∫–∏–π", "—Å—Ç—Ä–æ–∫–∞", "—á–∏—Å–ª–æ", "–±—É–ª–µ–≤—ã–π", "–∏—Å—Ç–∏–Ω–∞", "–ª–æ–∂—å", "—Ç–∏–ø",
                "–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å", "–º–æ–¥—É–ª—å", "–∏–º–ø–æ—Ä—Ç", "—ç–∫—Å–ø–æ—Ä—Ç", "–±–∏–±–ª–∏–æ—Ç–µ–∫–∞", "—Ñ—Ä–µ–π–º–≤–æ—Ä–∫", "–∫–æ–º–ø–∏–ª—è—Ç–æ—Ä", "–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä", "—Å–∏–Ω—Ç–∞–∫—Å–∏—Å", "–æ—Ç–ª–∞–¥–∫–∞"
            ],
            quotes: [
                "–õ—É—á—à–∏–π —Å–ø–æ—Å–æ–± –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –±—É–¥—É—â–µ–µ —Å–æ–∑–¥–∞—Ç—å –µ–≥–æ",
                "–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è –∏–∑ –Ω–∏—á–µ–≥–æ",
                "–ö–æ–¥ —ç—Ç–æ –ø–æ—ç–∑–∏—è –ª–æ–≥–∏–∫–∏",
                "–ü—Ä–µ–∂–¥–µ —á–µ–º –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —ç—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ",
                "–°–ª–æ–∂–Ω–æ—Å—Ç—å —É–±–∏–≤–∞–µ—Ç –æ–Ω–∞ –≤—ã—Å–∞—Å—ã–≤–∞–µ—Ç –∂–∏–∑–Ω—å –∏–∑ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤"
            ]
        };

        const textDisplay = document.getElementById('textDisplay');
        const typingInput = document.getElementById('typingInput');
        const timerElement = document.getElementById('timer');
        const dictionaryBtns = document.querySelectorAll('.dictionary-btn');
        const statsArea = document.getElementById('statsArea');
        const restartBtn = document.getElementById('restartBtn');
        const startBtn = document.getElementById('startBtn');
        const wpmStat = document.getElementById('wpmStat');
        const accuracyStat = document.getElementById('accuracyStat');
        const correctStat = document.getElementById('correctStat');
        const incorrectStat = document.getElementById('incorrectStat');
        const missedStat = document.getElementById('missedStat');
        const themeToggle = document.getElementById('themeToggle');

        let currentDictionary = 'russian';
        let text = '';
        let currentCharacterIndex = 0;
        let startTime;
        let timer;
        let timeLeft = 60;
        let correctCharacters = 0;
        let incorrectCharacters = 0;
        let missedCharacters = 0;
        let isTyping = false;
        let characterStates = [];

        function init() {
            currentCharacterIndex = 0;
            timeLeft = 60;
            correctCharacters = 0;
            incorrectCharacters = 0;
            missedCharacters = 0;
            isTyping = false;
            characterStates = [];
            
            text = getTextFromDictionary(dictionaries[currentDictionary]);
            characterStates = new Array(text.length).fill(null);
            
            renderText();
            
            typingInput.value = '';
            typingInput.disabled = false;
            timerElement.textContent = timeLeft;
            
            startBtn.classList.remove('hidden');
            timerElement.classList.add('hidden');
            textDisplay.classList.add('hidden');
            typingInput.classList.add('hidden');
            statsArea.classList.add('hidden');
            restartBtn.classList.add('hidden');
            
            if (timer) {
                clearInterval(timer);
            }
        }

        function getTextFromDictionary(dictionary) {
            if (currentDictionary === 'russian_proverbs' || currentDictionary === 'quotes') {
                return dictionary.join(' ');
            }
            
            const shuffled = [...dictionary].sort(() => 0.5 - Math.random());
            const words = shuffled.slice(0, 30);
            return words.join(' ');
        }

        function startTest() {
            if (isTyping) return;
            
            isTyping = true;
            startTime = new Date().getTime();
            
            timerElement.classList.remove('hidden');
            textDisplay.classList.remove('hidden');
            typingInput.classList.remove('hidden');
            startBtn.classList.add('hidden');
            
            typingInput.focus();
            
            timer = setInterval(() => {
                timeLeft--;
                timerElement.textContent = timeLeft;
                
                if (timeLeft <= 0) {
                    endTest();
                }
            }, 1000);
        }

        function renderText() {
            let html = '';
            
            for (let i = 0; i < text.length; i++) {
                let characterClass = '';
                
                if (characterStates[i] === 'correct') {
                    characterClass = 'correct';
                } else if (characterStates[i] === 'incorrect') {
                    characterClass = 'incorrect';
                } else if (characterStates[i] === 'missed') {
                    characterClass = 'missed';
                } else if (i === currentCharacterIndex) {
                    characterClass = 'current';
                }
                
                html += `<span class="character ${characterClass}">${text[i]}</span>`;
            }
            
            textDisplay.innerHTML = html;
            
            const currentCharElement = document.querySelector('.character.current');
            if (currentCharElement) {
                currentCharElement.scrollIntoView({
                    behavior: 'smooth',
                    block: 'center',
                    inline: 'center'
                });
            }
        }

        function endTest() {
            clearInterval(timer);
            typingInput.disabled = true;
            isTyping = false;
            
            for (let i = currentCharacterIndex; i < text.length; i++) {
                if (characterStates[i] === null) {
                    characterStates[i] = 'missed';
                    missedCharacters++;
                }
            }
            
            renderText();
            
            const totalCharacters = correctCharacters + incorrectCharacters + missedCharacters;
            const minutes = (60 - timeLeft) / 60;
            const wpm = Math.round((correctCharacters / 5) / minutes) || 0;
            const accuracy = Math.round((correctCharacters / (correctCharacters + incorrectCharacters + missedCharacters)) * 100) || 0;
            
            wpmStat.textContent = wpm;
            accuracyStat.textContent = accuracy + '%';
            correctStat.textContent = correctCharacters;
            incorrectStat.textContent = incorrectCharacters;
            missedStat.textContent = missedCharacters;
            
            statsArea.classList.remove('hidden');
            restartBtn.classList.remove('hidden');
        }

        function handleInput(e) {
            const inputValue = typingInput.value;
            
            if (inputValue.length === 0) return;
            
            const currentChar = text[currentCharacterIndex];
            
            if (inputValue === currentChar) {
                characterStates[currentCharacterIndex] = 'correct';
                correctCharacters++;
            } else {
                characterStates[currentCharacterIndex] = 'incorrect';
                incorrectCharacters++;
            }
            
            currentCharacterIndex++;
            typingInput.value = '';
            
            if (currentCharacterIndex === text.length) {
                endTest();
                return;
            }
            
            renderText();
        }

        function handleKeyDown(e) {
            if (e.key === ' ' && isTyping) {
                e.preventDefault();
                if (characterStates[currentCharacterIndex] === null) {
                    characterStates[currentCharacterIndex] = 'missed';
                    missedCharacters++;
                }
                currentCharacterIndex++;
                typingInput.value = '';
                
                if (currentCharacterIndex === text.length) {
                    endTest();
                    return;
                }
                
                renderText();
            }
            
            if (e.key === 'Tab') {
                e.preventDefault();
                init();
            }
        }

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            if (currentTheme === 'dark') {
                document.documentElement.removeAttribute('data-theme');
                localStorage.setItem('theme', 'light');
                themeToggle.textContent = 'üåô';
            } else {
                document.documentElement.setAttribute('data-theme', 'dark');
                localStorage.setItem('theme', 'dark');
                themeToggle.textContent = '‚òÄÔ∏è';
            }
        }

        function checkSavedTheme() {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
                themeToggle.textContent = '‚òÄÔ∏è';
            } else {
                themeToggle.textContent = 'üåô';
            }
        }

        typingInput.addEventListener('input', handleInput);
        document.addEventListener('keydown', handleKeyDown);
        
        dictionaryBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                dictionaryBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentDictionary = btn.dataset.dictionary;
                init();
            });
        });
        
        startBtn.addEventListener('click', startTest);
        restartBtn.addEventListener('click', init);
        themeToggle.addEventListener('click', toggleTheme);

        checkSavedTheme();
        init();
    </script>
</body>
</html>
