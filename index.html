<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TypeRacer | Тренажер печати</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #1a1a1a;
            --text-color: #e8e8e8;
            --correct-color: #4CAF50;
            --incorrect-color: #F44336;
            --current-color: #FF9800;
            --caret-color: #2196F3;
            --button-color: #3a3a3a;
            --button-hover: #4d4d4d;
            --border-radius: 4px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto Mono', monospace;
            background-color: var(--bg-color);
            color: var(--text-color);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .container {
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: var(--caret-color);
        }

        .subtitle {
            font-size: 1rem;
            opacity: 0.8;
        }

        .mode-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .mode-btn {
            padding: 8px 16px;
            background-color: var(--button-color);
            border: none;
            border-radius: var(--border-radius);
            color: var(--text-color);
            cursor: pointer;
            font-family: inherit;
            transition: background-color 0.2s;
        }

        .mode-btn:hover {
            background-color: var(--button-hover);
        }

        .mode-btn.active {
            background-color: var(--caret-color);
            color: #111;
        }

        .typing-container {
            width: 100%;
            margin-bottom: 30px;
        }

        .timer {
            font-size: 1.5rem;
            text-align: center;
            margin-bottom: 20px;
            color: var(--caret-color);
        }

        .text-display {
            font-size: 1.8rem;
            line-height: 2.5rem;
            padding: 20px;
            background-color: #252525;
            border-radius: var(--border-radius);
            min-height: 200px;
            position: relative;
            user-select: none;
        }

        .text-content {
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .hidden-input {
            position: absolute;
            opacity: 0;
            height: 0;
            width: 0;
        }

        .character {
            position: relative;
        }

        .character.correct {
            color: var(--correct-color);
        }

        .character.incorrect {
            color: var(--incorrect-color);
            text-decoration: underline;
        }

        .character.current {
            background-color: rgba(255, 152, 0, 0.2);
        }

        .character.current::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 2px;
            width: 100%;
            height: 3px;
            background-color: var(--current-color);
            animation: blink 1s infinite;
        }

        @keyframes blink {
            50% { opacity: 0; }
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat {
            background-color: #252525;
            padding: 15px;
            border-radius: var(--border-radius);
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--caret-color);
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: var(--border-radius);
            font-family: inherit;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background-color: var(--caret-color);
            color: #111;
        }

        .btn-primary:hover {
            background-color: #42a5f5;
        }

        .btn-secondary {
            background-color: var(--button-color);
            color: var(--text-color);
        }

        .btn-secondary:hover {
            background-color: var(--button-hover);
        }

        .hidden {
            display: none;
        }

        footer {
            margin-top: auto;
            padding-top: 30px;
            text-align: center;
            opacity: 0.6;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .text-display {
                font-size: 1.4rem;
                line-height: 2rem;
                min-height: 150px;
            }
            
            .stats {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 2rem;
            }
            
            .text-display {
                font-size: 1.2rem;
                line-height: 1.8rem;
                padding: 15px;
            }
            
            .controls {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>TypeRacer</h1>
            <p class="subtitle">Тренажер печати в стиле MonkeyType</p>
        </header>

        <div class="mode-selector">
            <button class="mode-btn active" data-mode="words">Слова</button>
            <button class="mode-btn" data-mode="quotes">Цитаты</button>
            <button class="mode-btn" data-mode="sentences">Предложения</button>
        </div>

        <div class="typing-container">
            <button class="btn btn-primary" id="startBtn">Начать тест</button>
            
            <div class="timer hidden" id="timer">60</div>
            
            <div class="text-display hidden" id="textDisplay">
                <div class="text-content" id="textContent"></div>
                <input type="text" class="hidden-input" id="typingInput" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
            </div>
            
            <div class="stats hidden" id="stats">
                <div class="stat">
                    <div class="stat-value" id="wpm">0</div>
                    <div class="stat-label">WPM</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="accuracy">0</div>
                    <div class="stat-label">Точность</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="correct">0</div>
                    <div class="stat-label">Правильно</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="incorrect">0</div>
                    <div class="stat-label">Ошибки</div>
                </div>
            </div>
            
            <div class="controls hidden" id="controls">
                <button class="btn btn-primary" id="restartBtn">Заново</button>
                <button class="btn btn-secondary" id="changeModeBtn">Сменить режим</button>
            </div>
        </div>
    </div>

    <footer>
        <p>TypeRacer &copy; 2023 | Тренажер скорости печати</p>
    </footer>

    <script>
        // Данные для разных режимов
        const data = {
            words: [
                "привет", "мир", "программа", "язык", "компьютер", "клавиатура", "монитор", 
                "мышь", "система", "файл", "папка", "документ", "текст", "страница", "строка"
            ],
            quotes: [
                "Код — это поэзия.", 
                "Программирование — это искусство.", 
                "Чем меньше кода, тем меньше ошибок.",
                "Сначала решите проблему, затем пишите код.",
                "Лучший код — это отсутствие кода."
            ],
            sentences: [
                "Я люблю программировать на JavaScript.",
                "React — это популярная библиотека для создания интерфейсов.",
                "Веб-разработка включает в себя фронтенд и бэкенд.",
                "Алгоритмы и структуры данных важны для программиста.",
                "Тестирование кода помогает находить ошибки."
            ]
        };

        // Элементы DOM
        const textContent = document.getElementById('textContent');
        const typingInput = document.getElementById('typingInput');
        const timerElement = document.getElementById('timer');
        const modeBtns = document.querySelectorAll('.mode-btn');
        const statsElement = document.getElementById('stats');
        const controlsElement = document.getElementById('controls');
        const startBtn = document.getElementById('startBtn');
        const restartBtn = document.getElementById('restartBtn');
        const changeModeBtn = document.getElementById('changeModeBtn');
        const wpmElement = document.getElementById('wpm');
        const accuracyElement = document.getElementById('accuracy');
        const correctElement = document.getElementById('correct');
        const incorrectElement = document.getElementById('incorrect');

        // Состояние приложения
        let currentMode = 'words';
        let text = '';
        let typedText = '';
        let startTime;
        let timer;
        let timeLeft = 60;
        let correctChars = 0;
        let incorrectChars = 0;
        let isTyping = false;

        // Инициализация
        function init() {
            typedText = '';
            timeLeft = 60;
            correctChars = 0;
            incorrectChars = 0;
            isTyping = false;
            
            // Генерация текста в зависимости от режима
            switch(currentMode) {
                case 'words':
                    text = generateWordsText();
                    break;
                case 'quotes':
                    text = data.quotes[Math.floor(Math.random() * data.quotes.length)];
                    break;
                case 'sentences':
                    text = data.sentences[Math.floor(Math.random() * data.sentences.length)];
                    break;
                default:
                    text = generateWordsText();
            }
            
            renderText();
            
            timerElement.textContent = timeLeft;
            startBtn.classList.remove('hidden');
            timerElement.classList.add('hidden');
            textDisplay.classList.add('hidden');
            statsElement.classList.add('hidden');
            controlsElement.classList.add('hidden');
            
            if (timer) {
                clearInterval(timer);
            }
        }

        // Генерация текста из случайных слов
        function generateWordsText() {
            const shuffled = [...data.words].sort(() => 0.5 - Math.random());
            return shuffled.slice(0, 30).join(' ');
        }

        // Начало теста
        function startTest() {
            if (isTyping) return;
            
            isTyping = true;
            startTime = new Date().getTime();
            typedText = '';
            
            timerElement.classList.remove('hidden');
            textDisplay.classList.remove('hidden');
            startBtn.classList.add('hidden');
            
            typingInput.value = '';
            typingInput.focus();
            
            timer = setInterval(() => {
                timeLeft--;
                timerElement.textContent = timeLeft;
                
                if (timeLeft <= 0) {
                    endTest();
                }
            }, 1000);
        }

        // Отрисовка текста с подсветкой
        function renderText() {
            let html = '';
            
            for (let i = 0; i < text.length; i++) {
                let char = text[i];
                let charClass = '';
                
                if (i < typedText.length) {
                    charClass = text[i] === typedText[i] ? 'correct' : 'incorrect';
                } else if (i === typedText.length) {
                    charClass = 'current';
                }
                
                html += `<span class="character ${charClass}">${char}</span>`;
            }
            
            // Добавляем лишние символы (если есть)
            if (typedText.length > text.length) {
                for (let i = text.length; i < typedText.length; i++) {
                    html += `<span class="character incorrect extra">${typedText[i]}</span>`;
                }
            }
            
            textContent.innerHTML = html;
            
            // Прокрутка к текущему символу
            const currentChar = document.querySelector('.character.current');
            if (currentChar) {
                currentChar.scrollIntoView({
                    behavior: 'smooth',
                    block: 'center',
                    inline: 'center'
                });
            }
        }

        // Завершение теста
        function endTest() {
            clearInterval(timer);
            isTyping = false;
            typingInput.blur();
            
            // Расчет статистики
            const minutes = (60 - timeLeft) / 60;
            const wpm = Math.round((correctChars / 5) / minutes) || 0;
            const accuracy = Math.round((correctChars / (correctChars + incorrectChars)) * 100) || 0;
            
            wpmElement.textContent = wpm;
            accuracyElement.textContent = accuracy + '%';
            correctElement.textContent = correctChars;
            incorrectElement.textContent = incorrectChars;
            
            statsElement.classList.remove('hidden');
            controlsElement.classList.remove('hidden');
        }

        // Обработка ввода
        function handleInput(e) {
            if (!isTyping) return;
            
            typedText = typingInput.value;
            
            // Подсчет правильных и неправильных символов
            correctChars = 0;
            incorrectChars = 0;
            
            for (let i = 0; i < typedText.length; i++) {
                if (i < text.length && typedText[i] === text[i]) {
                    correctChars++;
                } else {
                    incorrectChars++;
                }
            }
            
            renderText();
            
            // Автоматическое завершение при достижении конца текста
            if (typedText.length >= text.length) {
                endTest();
            }
        }

        // Смена режима
        function changeMode(mode) {
            currentMode = mode;
            init();
        }

        // События
        typingInput.addEventListener('input', handleInput);
        
        modeBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                modeBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                changeMode(btn.dataset.mode);
            });
        });
        
        startBtn.addEventListener('click', startTest);
        restartBtn.addEventListener('click', init);
        changeModeBtn.addEventListener('click', () => {
            init();
            document.querySelector('.mode-selector').scrollIntoView({
                behavior: 'smooth'
            });
        });

        // Инициализация при загрузке
        init();
    </script>
</body>
</html>
