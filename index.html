<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TypeMaster | Тренажер печати</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #7c4dff;
            --primary-light: #9a76ff;
            --primary-dark: #5e35b1;
            --background: #121212;
            --surface: #1e1e1e;
            --surface-light: #2d2d2d;
            --text-primary: #e0e0e0;
            --text-secondary: #a0a0a0;
            --correct: #00c853;
            --incorrect: #ff5252;
            --current: var(--primary-light);
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            --border-radius: 8px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'JetBrains Mono', monospace;
            background-color: var(--background);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            width: 100%;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--primary);
        }

        .subtitle {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .dictionary-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .dictionary-btn {
            padding: 8px 16px;
            border-radius: var(--border-radius);
            border: none;
            background-color: var(--surface-light);
            color: var(--text-primary);
            font-family: inherit;
            font-weight: 500;
            cursor: pointer;
        }

        .dictionary-btn.active {
            background-color: var(--primary);
            color: white;
        }

        .typing-container {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .timer {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 20px;
            text-align: center;
        }

        .text-display {
            font-size: 1.5rem;
            line-height: 2;
            margin-bottom: 20px;
            padding: 15px;
            background-color: var(--surface);
            border-radius: var(--border-radius);
            min-height: 150px;
            position: relative;
        }

        .text-content {
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .input-cursor {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: text;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-box {
            background-color: var(--surface);
            border-radius: var(--border-radius);
            padding: 15px;
            text-align: center;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: var(--border-radius);
            font-family: inherit;
            font-weight: 600;
            cursor: pointer;
            flex: 1;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-secondary {
            background-color: var(--surface-light);
            color: var(--text-primary);
        }

        .hidden {
            display: none;
        }

        .character {
            position: relative;
        }

        .character.correct {
            color: var(--correct);
        }

        .character.incorrect {
            color: var(--incorrect);
        }

        .character.extra {
            color: var(--incorrect);
            text-decoration: underline;
        }

        .character.current {
            background-color: rgba(124, 77, 255, 0.2);
            border-radius: 3px;
        }

        .character.current::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 2px;
            width: 100%;
            height: 2px;
            background-color: var(--current);
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        footer {
            text-align: center;
            margin-top: 30px;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            body {
                padding: 15px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .text-display {
                font-size: 1.3rem;
                min-height: 120px;
            }
            
            .stats {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .text-display {
                font-size: 1.1rem;
                line-height: 1.8;
            }
            
            .controls {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>TypeMaster</h1>
            <p class="subtitle">Тренажер печати в стиле MonkeyType</p>
        </header>

        <div class="dictionary-selector">
            <button class="dictionary-btn active" data-dictionary="russian">Русские слова</button>
            <button class="dictionary-btn" data-dictionary="russian_proverbs">Пословицы</button>
            <button class="dictionary-btn" data-dictionary="programming">Программирование</button>
            <button class="dictionary-btn" data-dictionary="quotes">Цитаты</button>
        </div>

        <div class="typing-container">
            <button class="btn btn-primary" id="startBtn">Начать тест</button>
            
            <div class="timer hidden" id="timer">60</div>
            
            <div class="text-display hidden" id="textDisplay">
                <div class="text-content" id="textContent"></div>
                <textarea class="input-cursor" id="typingInput" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false"></textarea>
            </div>
            
            <div class="stats hidden" id="statsArea">
                <div class="stat-box">
                    <div class="stat-value" id="wpmStat">0</div>
                    <div class="stat-label">Скорость (WPM)</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="accuracyStat">0</div>
                    <div class="stat-label">Точность</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="correctStat">0</div>
                    <div class="stat-label">Правильно</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="incorrectStat">0</div>
                    <div class="stat-label">Ошибки</div>
                </div>
            </div>
            
            <div class="controls hidden" id="controlsArea">
                <button class="btn btn-primary" id="restartBtn">Повторить</button>
                <button class="btn btn-secondary" id="changeDictBtn">Сменить словарь</button>
            </div>
        </div>
    </div>

    <footer>
        <p>TypeMaster &copy; 2023 | Тренажер для развития скорости печати</p>
    </footer>

    <script>
        const dictionaries = {
            russian: [
                "привет", "мир", "программа", "язык", "компьютер", "клавиатура", "монитор", "мышь", "система", "файл",
                "папка", "документ", "текст", "страница", "строка", "слово", "буква", "цифра", "число", "код",
                "алгоритм", "программист", "разработчик", "интерфейс", "функция", "переменная", "значение", "оператор", "условие", "цикл"
            ],
            russian_proverbs: [
                "Без труда не вытащишь и рыбку из пруда",
                "В гостях хорошо а дома лучше",
                "Волков бояться в лес не ходить",
                "Глаза боятся а руки делают",
                "Дело мастера боится"
            ],
            programming: [
                "функция", "переменная", "цикл", "массив", "объект", "класс", "метод", "параметр", "аргумент", "возврат",
                "константа", "условие", "оператор", "логический", "строка", "число", "булевый", "истина", "ложь", "тип"
            ],
            quotes: [
                "Лучший способ предсказать будущее создать его",
                "Программирование это искусство создавать решения из ничего",
                "Код это поэзия логики",
                "Прежде чем оптимизировать убедитесь что это необходимо",
                "Сложность убивает она высасывает жизнь из разработчиков"
            ]
        };

        const textContent = document.getElementById('textContent');
        const typingInput = document.getElementById('typingInput');
        const timerElement = document.getElementById('timer');
        const dictionaryBtns = document.querySelectorAll('.dictionary-btn');
        const statsArea = document.getElementById('statsArea');
        const controlsArea = document.getElementById('controlsArea');
        const restartBtn = document.getElementById('restartBtn');
        const changeDictBtn = document.getElementById('changeDictBtn');
        const startBtn = document.getElementById('startBtn');
        const wpmStat = document.getElementById('wpmStat');
        const accuracyStat = document.getElementById('accuracyStat');
        const correctStat = document.getElementById('correctStat');
        const incorrectStat = document.getElementById('incorrectStat');

        let currentDictionary = 'russian';
        let text = '';
        let typedText = '';
        let startTime;
        let timer;
        let timeLeft = 60;
        let correctCharacters = 0;
        let incorrectCharacters = 0;
        let isTyping = false;

        function init() {
            typedText = '';
            timeLeft = 60;
            correctCharacters = 0;
            incorrectCharacters = 0;
            isTyping = false;
            
            text = getTextFromDictionary(dictionaries[currentDictionary]);
            renderText();
            
            timerElement.textContent = timeLeft;
            
            startBtn.classList.remove('hidden');
            timerElement.classList.add('hidden');
            textDisplay.classList.add('hidden');
            statsArea.classList.add('hidden');
            controlsArea.classList.add('hidden');
            
            if (timer) {
                clearInterval(timer);
            }
        }

        function getTextFromDictionary(dictionary) {
            if (currentDictionary === 'russian_proverbs' || currentDictionary === 'quotes') {
                return dictionary.join(' ');
            }
            
            const shuffled = [...dictionary].sort(() => 0.5 - Math.random());
            const words = shuffled.slice(0, 25);
            return words.join(' ');
        }

        function startTest() {
            if (isTyping) return;
            
            isTyping = true;
            startTime = new Date().getTime();
            typedText = '';
            
            timerElement.classList.remove('hidden');
            textDisplay.classList.remove('hidden');
            startBtn.classList.add('hidden');
            
            typingInput.focus();
            
            timer = setInterval(() => {
                timeLeft--;
                timerElement.textContent = timeLeft;
                
                if (timeLeft <= 0) {
                    endTest();
                }
            }, 1000);
        }

        function renderText() {
            let html = '';
            let currentPos = typedText.length;
            
            for (let i = 0; i < text.length; i++) {
                let char = text[i];
                let charClass = '';
                
                if (i < typedText.length) {
                    charClass = text[i] === typedText[i] ? 'correct' : 'incorrect';
                } else if (i === typedText.length) {
                    charClass = 'current';
                }
                
                html += `<span class="character ${charClass}">${char}</span>`;
            }
            
            if (typedText.length > text.length) {
                for (let i = text.length; i < typedText.length; i++) {
                    html += `<span class="character extra">${typedText[i]}</span>`;
                }
            }
            
            textContent.innerHTML = html;
            
            const currentCharElement = document.querySelector('.character.current');
            if (currentCharElement) {
                currentCharElement.scrollIntoView({
                    behavior: 'smooth',
                    block: 'center',
                    inline: 'center'
                });
            }
        }

        function endTest() {
            clearInterval(timer);
            isTyping = false;
            typingInput.blur();
            
            const minutes = (60 - timeLeft) / 60;
            const wpm = Math.round((correctCharacters / 5) / minutes) || 0;
            const accuracy = Math.round((correctCharacters / (correctCharacters + incorrectCharacters)) * 100) || 0;
            
            wpmStat.textContent = wpm;
            accuracyStat.textContent = accuracy;
            correctStat.textContent = correctCharacters;
            incorrectStat.textContent = incorrectCharacters;
            
            statsArea.classList.remove('hidden');
            controlsArea.classList.remove('hidden');
        }

        function handleInput(e) {
            if (!isTyping) return;
            
            typedText = typingInput.value;
            
            correctCharacters = 0;
            incorrectCharacters = 0;
            
            for (let i = 0; i < typedText.length; i++) {
                if (i < text.length && typedText[i] === text[i]) {
                    correctCharacters++;
                } else {
                    incorrectCharacters++;
                }
            }
            
            renderText();
            
            if (typedText.length >= text.length) {
                endTest();
            }
        }

        typingInput.addEventListener('input', handleInput);
        
        dictionaryBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                dictionaryBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentDictionary = btn.dataset.dictionary;
                init();
            });
        });
        
        startBtn.addEventListener('click', startTest);
        restartBtn.addEventListener('click', init);
        changeDictBtn.addEventListener('click', () => {
            init();
            document.querySelector('.dictionary-selector').scrollIntoView({
                behavior: 'smooth'
            });
        });

        init();
    </script>
</body>
</html>
