<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TypeMaster | Тренажер печати</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #7c4dff;
            --primary-light: #9a76ff;
            --primary-dark: #5e35b1;
            --secondary: #00e5ff;
            --background: #121212;
            --surface: #1e1e1e;
            --surface-light: #2d2d2d;
            --text-primary: #e0e0e0;
            --text-secondary: #a0a0a0;
            --correct: #00c853;
            --incorrect: #ff5252;
            --missed: #ffab40;
            --current: var(--primary-light);
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            --border-radius: 12px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: var(--transition);
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--background);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            padding: 1rem;
            line-height: 1.6;
        }

        header {
            text-align: center;
            margin-bottom: 2rem;
            position: relative;
        }

        h1 {
            font-size: clamp(2rem, 5vw, 3rem);
            font-weight: 700;
            margin-bottom: 0.5rem;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            letter-spacing: -0.5px;
        }

        .subtitle {
            font-size: clamp(1rem, 3vw, 1.2rem);
            color: var(--text-secondary);
            font-weight: 400;
            max-width: 600px;
            margin: 0 auto;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            width: 100%;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .card {
            background-color: var(--surface);
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--shadow);
            margin-bottom: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .dictionary-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .dictionary-btn {
            padding: 0.75rem 1.25rem;
            border-radius: 8px;
            border: none;
            background-color: var(--surface-light);
            color: var(--text-primary);
            font-family: inherit;
            font-weight: 500;
            cursor: pointer;
            font-size: 0.95rem;
            transition: var(--transition);
        }

        .dictionary-btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
        }

        .dictionary-btn.active {
            background-color: var(--primary);
            color: white;
            box-shadow: 0 4px 16px rgba(124, 77, 255, 0.3);
        }

        .typing-area {
            margin-bottom: 1.5rem;
        }

        .timer {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 1.5rem;
            text-align: center;
            font-feature-settings: "tnum";
        }

        .text-display {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.5rem;
            line-height: 2.25rem;
            margin-bottom: 2rem;
            min-height: 9rem;
            padding: 1.5rem;
            background-color: var(--surface-light);
            border-radius: var(--border-radius);
            white-space: pre-wrap;
            word-wrap: break-word;
            overflow-wrap: break-word;
            overflow-y: auto;
            max-height: 250px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .input-container {
            position: relative;
            margin-bottom: 1.5rem;
        }

        .input-area {
            width: 100%;
            padding: 1.25rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.25rem;
            border: 2px solid var(--surface-light);
            border-radius: var(--border-radius);
            outline: none;
            background-color: var(--surface-light);
            color: var(--text-primary);
            caret-color: var(--primary);
        }

        .input-area:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(124, 77, 255, 0.2);
        }

        .input-hint {
            position: absolute;
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            font-size: 0.9rem;
            pointer-events: none;
        }

        .btn {
            padding: 1rem 2rem;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            font-family: inherit;
            font-weight: 600;
            cursor: pointer;
            font-size: 1rem;
            box-shadow: 0 4px 16px rgba(124, 77, 255, 0.3);
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .btn:hover {
            background-color: var(--primary-light);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(124, 77, 255, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-outline {
            background-color: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
            box-shadow: none;
        }

        .btn-outline:hover {
            background-color: rgba(124, 77, 255, 0.1);
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-box {
            background-color: var(--surface-light);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.25rem;
            font-feature-settings: "tnum";
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 500;
        }

        .hidden {
            display: none;
        }

        .character {
            position: relative;
            transition: color 0.1s ease;
        }

        .character.correct {
            color: var(--correct);
        }

        .character.incorrect {
            color: var(--incorrect);
            text-decoration: underline wavy var(--incorrect);
        }

        .character.missed {
            color: var(--missed);
            text-decoration: underline dotted var(--missed);
        }

        .character.current {
            background-color: rgba(124, 77, 255, 0.15);
            border-radius: 4px;
        }

        .character.current::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: -4px;
            width: 100%;
            height: 3px;
            background-color: var(--current);
            animation: blink 1.2s infinite;
            border-radius: 2px;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        footer {
            text-align: center;
            margin-top: 3rem;
            color: var(--text-secondary);
            font-size: 0.9rem;
            padding: 1rem;
        }

        @media (max-width: 768px) {
            .card {
                padding: 1.5rem;
            }
            
            .text-display {
                font-size: 1.25rem;
                line-height: 2rem;
                padding: 1rem;
                min-height: 7rem;
                max-height: 200px;
            }
            
            .input-area {
                padding: 1rem;
                font-size: 1.1rem;
            }
            
            .btn {
                padding: 0.9rem 1.5rem;
                width: 100%;
            }
            
            .actions {
                flex-direction: column;
                gap: 0.75rem;
            }
            
            .stat-box {
                padding: 1rem;
            }
            
            .stat-value {
                font-size: 2rem;
            }
        }

        @media (max-width: 480px) {
            .card {
                padding: 1.25rem;
            }
            
            .dictionary-selector {
                gap: 0.5rem;
            }
            
            .dictionary-btn {
                padding: 0.6rem 1rem;
                font-size: 0.85rem;
            }
            
            .text-display {
                font-size: 1.1rem;
                line-height: 1.8rem;
                min-height: 6rem;
                max-height: 180px;
            }
            
            .input-area {
                padding: 0.9rem;
                font-size: 1rem;
            }
            
            .stat-box {
                padding: 0.8rem;
            }
            
            .stat-value {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>TypeMaster</h1>
            <p class="subtitle">Совершенствуйте навыки печати с красивым и удобным тренажером</p>
        </header>

        <div class="card">
            <h2>Выберите словарь</h2>
            <div class="dictionary-selector">
                <button class="dictionary-btn active" data-dictionary="russian">Русские слова</button>
                <button class="dictionary-btn" data-dictionary="russian_proverbs">Пословицы</button>
                <button class="dictionary-btn" data-dictionary="programming">Программирование</button>
                <button class="dictionary-btn" data-dictionary="quotes">Цитаты</button>
            </div>
        </div>

        <div class="card typing-area">
            <button class="btn" id="startBtn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M8 5V19L19 12L8 5Z" fill="currentColor"/>
                </svg>
                Начать тест
            </button>
            
            <div class="timer hidden" id="timer">60</div>
            
            <div class="text-display hidden" id="textDisplay"></div>
            
            <div class="input-container hidden" id="inputContainer">
                <input type="text" class="input-area" id="typingInput" placeholder="Начните печатать..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
                <div class="input-hint" id="inputHint">Пробел - пропуск</div>
            </div>
            
            <div class="stats hidden" id="statsArea">
                <div class="stat-box">
                    <div class="stat-value" id="wpmStat">0</div>
                    <div class="stat-label">Скорость (WPM)</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="accuracyStat">0</div>
                    <div class="stat-label">Точность</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="correctStat">0</div>
                    <div class="stat-label">Правильно</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="incorrectStat">0</div>
                    <div class="stat-label">Ошибки</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="missedStat">0</div>
                    <div class="stat-label">Пропущено</div>
                </div>
            </div>
            
            <div class="actions hidden" id="actionsArea">
                <button class="btn" id="restartBtn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 5V2L8 6L12 10V7C15.31 7 18 9.69 18 13C18 16.31 15.31 19 12 19C8.69 19 6 16.31 6 13H4C4 17.42 7.58 21 12 21C16.42 21 20 17.42 20 13C20 8.58 16.42 5 12 5Z" fill="currentColor"/>
                    </svg>
                    Попробовать снова
                </button>
                <button class="btn btn-outline" id="changeDictBtn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M3 17V19H9V17H3ZM3 5V7H13V5H3ZM13 21V19H21V17H13V15H11V21H13ZM7 9V11H3V13H7V15H9V9H7ZM21 13V11H11V13H21ZM15 9H17V7H21V5H17V3H15V9Z" fill="currentColor"/>
                    </svg>
                    Сменить словарь
                </button>
            </div>
        </div>
    </div>

    <footer>
        <p>TypeMaster &copy; 2023 | Тренажер для развития скорости печати</p>
    </footer>

    <script>
        const dictionaries = {
            russian: [
                "привет", "мир", "программа", "язык", "компьютер", "клавиатура", "монитор", "мышь", "система", "файл",
                "папка", "документ", "текст", "страница", "строка", "слово", "буква", "цифра", "число", "код",
                "алгоритм", "программист", "разработчик", "интерфейс", "функция", "переменная", "значение", "оператор", "условие", "цикл",
                "массив", "объект", "класс", "метод", "параметр", "аргумент", "возврат", "константа", "строка", "логический"
            ],
            russian_proverbs: [
                "Без труда не вытащишь и рыбку из пруда",
                "В гостях хорошо а дома лучше",
                "Волков бояться в лес не ходить",
                "Глаза боятся а руки делают",
                "Дело мастера боится",
                "За двумя зайцами погонишься ни одного не поймаешь",
                "Копейка рубль бережет",
                "Кто рано встает тому бог подает",
                "Любишь кататься люби и саночки возить",
                "Москва не сразу строилась"
            ],
            programming: [
                "функция", "переменная", "цикл", "массив", "объект", "класс", "метод", "параметр", "аргумент", "возврат",
                "константа", "условие", "оператор", "логический", "строка", "число", "булевый", "истина", "ложь", "тип",
                "интерфейс", "модуль", "импорт", "экспорт", "библиотека", "фреймворк", "компилятор", "интерпретатор", "синтаксис", "отладка"
            ],
            quotes: [
                "Лучший способ предсказать будущее создать его",
                "Программирование это искусство создавать решения из ничего",
                "Код это поэзия логики",
                "Прежде чем оптимизировать убедитесь что это необходимо",
                "Сложность убивает она высасывает жизнь из разработчиков"
            ]
        };

        const textDisplay = document.getElementById('textDisplay');
        const typingInput = document.getElementById('typingInput');
        const timerElement = document.getElementById('timer');
        const inputContainer = document.getElementById('inputContainer');
        const inputHint = document.getElementById('inputHint');
        const dictionaryBtns = document.querySelectorAll('.dictionary-btn');
        const statsArea = document.getElementById('statsArea');
        const actionsArea = document.getElementById('actionsArea');
        const restartBtn = document.getElementById('restartBtn');
        const changeDictBtn = document.getElementById('changeDictBtn');
        const startBtn = document.getElementById('startBtn');
        const wpmStat = document.getElementById('wpmStat');
        const accuracyStat = document.getElementById('accuracyStat');
        const correctStat = document.getElementById('correctStat');
        const incorrectStat = document.getElementById('incorrectStat');
        const missedStat = document.getElementById('missedStat');

        let currentDictionary = 'russian';
        let text = '';
        let currentCharacterIndex = 0;
        let startTime;
        let timer;
        let timeLeft = 60;
        let correctCharacters = 0;
        let incorrectCharacters = 0;
        let missedCharacters = 0;
        let isTyping = false;
        let characterStates = [];
        let backspacePressed = false;

        function init() {
            currentCharacterIndex = 0;
            timeLeft = 60;
            correctCharacters = 0;
            incorrectCharacters = 0;
            missedCharacters = 0;
            isTyping = false;
            characterStates = [];
            backspacePressed = false;
            
            text = getTextFromDictionary(dictionaries[currentDictionary]);
            characterStates = new Array(text.length).fill(null);
            
            renderText();
            
            typingInput.value = '';
            typingInput.disabled = false;
            timerElement.textContent = timeLeft;
            
            startBtn.classList.remove('hidden');
            timerElement.classList.add('hidden');
            textDisplay.classList.add('hidden');
            inputContainer.classList.add('hidden');
            statsArea.classList.add('hidden');
            actionsArea.classList.add('hidden');
            
            if (timer) {
                clearInterval(timer);
            }
        }

        function getTextFromDictionary(dictionary) {
            if (currentDictionary === 'russian_proverbs' || currentDictionary === 'quotes') {
                return dictionary.join(' ');
            }
            
            const shuffled = [...dictionary].sort(() => 0.5 - Math.random());
            const words = shuffled.slice(0, 30);
            return words.join(' ');
        }

        function startTest() {
            if (isTyping) return;
            
            isTyping = true;
            startTime = new Date().getTime();
            
            timerElement.classList.remove('hidden');
            textDisplay.classList.remove('hidden');
            inputContainer.classList.remove('hidden');
            startBtn.classList.add('hidden');
            
            typingInput.focus();
            
            timer = setInterval(() => {
                timeLeft--;
                timerElement.textContent = timeLeft;
                
                if (timeLeft <= 0) {
                    endTest();
                }
            }, 1000);
        }

        function renderText() {
            let html = '';
            
            for (let i = 0; i < text.length; i++) {
                let characterClass = '';
                
                if (characterStates[i] === 'correct') {
                    characterClass = 'correct';
                } else if (characterStates[i] === 'incorrect') {
                    characterClass = 'incorrect';
                } else if (characterStates[i] === 'missed') {
                    characterClass = 'missed';
                } else if (i === currentCharacterIndex) {
                    characterClass = 'current';
                }
                
                html += `<span class="character ${characterClass}">${text[i]}</span>`;
            }
            
            textDisplay.innerHTML = html;
            
            const currentCharElement = document.querySelector('.character.current');
            if (currentCharElement) {
                currentCharElement.scrollIntoView({
                    behavior: 'smooth',
                    block: 'center',
                    inline: 'center'
                });
            }
        }

        function endTest() {
            clearInterval(timer);
            typingInput.disabled = true;
            isTyping = false;
            
            for (let i = currentCharacterIndex; i < text.length; i++) {
                if (characterStates[i] === null) {
                    characterStates[i] = 'missed';
                    missedCharacters++;
                }
            }
            
            renderText();
            
            const totalTyped = correctCharacters + incorrectCharacters;
            const totalCharacters = correctCharacters + incorrectCharacters + missedCharacters;
            const minutes = (60 - timeLeft) / 60;
            const wpm = Math.round((correctCharacters / 5) / minutes) || 0;
            const accuracy = totalTyped > 0 ? Math.round((correctCharacters / totalTyped) * 100) : 0;
            
            wpmStat.textContent = wpm;
            accuracyStat.textContent = accuracy;
            correctStat.textContent = correctCharacters;
            incorrectStat.textContent = incorrectCharacters;
            missedStat.textContent = missedCharacters;
            
            statsArea.classList.remove('hidden');
            actionsArea.classList.remove('hidden');
        }

        function handleInput(e) {
            const inputValue = typingInput.value;
            
            if (inputValue.length === 0) {
                if (backspacePressed && currentCharacterIndex > 0) {
                    currentCharacterIndex--;
                    if (characterStates[currentCharacterIndex] === 'incorrect') {
                        characterStates[currentCharacterIndex] = null;
                        incorrectCharacters--;
                    } else if (characterStates[currentCharacterIndex] === 'correct') {
                        characterStates[currentCharacterIndex] = null;
                        correctCharacters--;
                    }
                    renderText();
                }
                backspacePressed = false;
                return;
            }
            
            const currentChar = text[currentCharacterIndex];
            
            if (inputValue === currentChar) {
                characterStates[currentCharacterIndex] = 'correct';
                correctCharacters++;
            } else {
                characterStates[currentCharacterIndex] = 'incorrect';
                incorrectCharacters++;
            }
            
            currentCharacterIndex++;
            typingInput.value = '';
            backspacePressed = false;
            
            if (currentCharacterIndex === text.length) {
                endTest();
                return;
            }
            
            renderText();
        }

        function handleKeyDown(e) {
            if (e.key === ' ' && isTyping) {
                e.preventDefault();
                if (characterStates[currentCharacterIndex] === null) {
                    characterStates[currentCharacterIndex] = 'missed';
                    missedCharacters++;
                }
                currentCharacterIndex++;
                typingInput.value = '';
                
                if (currentCharacterIndex === text.length) {
                    endTest();
                    return;
                }
                
                renderText();
            }
            
            if (e.key === 'Backspace') {
                backspacePressed = true;
            }
            
            if (e.key === 'Tab') {
                e.preventDefault();
                init();
            }
        }

        typingInput.addEventListener('input', handleInput);
        document.addEventListener('keydown', handleKeyDown);
        
        dictionaryBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                dictionaryBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentDictionary = btn.dataset.dictionary;
                init();
            });
        });
        
        startBtn.addEventListener('click', startTest);
        restartBtn.addEventListener('click', init);
        changeDictBtn.addEventListener('click', () => {
            init();
            document.querySelector('.dictionary-selector').scrollIntoView({
                behavior: 'smooth'
            });
        });

        init();
    </script>
</body>
</html>
